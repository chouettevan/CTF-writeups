# JKT Check-in KiosK



The challenge includes a [zip](https://github.com/chouettevan/CTF-writeups/blob/main/assets/united2025/pwn/src.zip) file containing a binary,as well as its libc and ld.so versions.

## 1 . Reverse engineering
using radare2, we can see the main challenge binary has the follwing functions:
```
[0x00401410]> afl
0x004010e0    1     11 sym.imp.puts
0x004010f0    1     11 sym.imp.fread
0x00401100    1     11 sym.imp.close
0x00401110    1     11 sym.imp.read
0x00401120    1     11 sym.imp.fgets
0x00401130    1     11 sym.imp.malloc
0x00401140    1     11 sym.imp.fflush
0x00401150    1     11 sym.imp.setvbuf
0x00401160    1     11 sym.imp.open
0x00401170    1     11 sym.imp.fopen
0x00401180    1     11 sym.imp.fwrite
0x00401410    1     46 entry0
0x00401450    4     31 sym.deregister_tm_clones
0x00401480    4     49 sym.register_tm_clones
0x004014c0    3     32 entry.fini0
0x004014f0    1      6 entry.init0
0x00401570    1      5 sym.__libc_csu_fini
0x00401578    1     13 sym._fini
0x00401500    4    101 sym.__libc_csu_init
0x00401440    1      5 sym._dl_relocate_static_pie
0x00401190   18    607 main
0x00401000    3     27 sym._init
0x00401030    2     28 fcn.00401030
0x00401040    1     15 fcn.00401040
0x00401050    1     15 fcn.00401050
0x00401060    1     15 fcn.00401060
0x00401070    1     15 fcn.00401070
0x00401080    1     15 fcn.00401080
0x00401090    1     15 fcn.00401090
0x004010a0    1     15 fcn.004010a0
0x004010b0    1     15 fcn.004010b0
0x004010c0    1     15 fcn.004010c0
0x004010d0    1     15 fcn.004010d0
```
```{css, echo=FALSE}
.scroll-100 {
  max-height: 100px;
  overflow-y: auto;
  background-color: inherit;
}
```
looking at main and reading the graph view of the assembly
```{class.output="scroll-100"}
                                                                                                                                                                                                                  ┌──────────────────────────────────────────────────────────────┐
                                                                                                                                                                                                                  │  0x401190                                                    │
                                                                                                                                                                                                                  │ ; [15] -r-x section size 997 named .text                     │
                                                                                                                                                                                                                  │   ;-- section..text:                                         │
                                                                                                                                                                                                                  │   ; ICOD XREF from entry0 @ 0x401431(r)                      │
                                                                                                                                                                                                                  │ 607: int main (int argc, char **argv, char **envp);          │
                                                                                                                                                                                                                  │ afv: vars(1:sp[0x30..0x30])                                  │
                                                                                                                                                                                                                  │ endbr64                                                      │
                                                                                                                                                                                                                  │ push r13                                                     │
                                                                                                                                                                                                                  │ ; size_t size                                                │
                                                                                                                                                                                                                  │ xor ecx, ecx                                                 │
                                                                                                                                                                                                                  │ ; int mode                                                   │
                                                                                                                                                                                                                  │ mov edx, 2                                                   │
                                                                                                                                                                                                                  │ ; char *buf                                                  │
                                                                                                                                                                                                                  │ xor esi, esi                                                 │
                                                                                                                                                                                                                  │ push r12                                                     │
                                                                                                                                                                                                                  │ push rbp                                                     │
                                                                                                                                                                                                                  │ ; 'flag-fak'                                                 │
                                                                                                                                                                                                                  │ movabs rbp, 0x6b61662d67616c66                               │
                                                                                                                                                                                                                  │ push rbx                                                     │
                                                                                                                                                                                                                  │ sub rsp, 0x18                                                │
                                                                                                                                                                                                                  │ ; FILE*stream                                                │
                                                                                                                                                                                                                  │ ; obj.stdout__GLIBC_2.2.5                                    │
                                                                                                                                                                                                                  │ ; [0x404020:8]=0                                             │
                                                                                                                                                                                                                  │ mov rdi, qword [obj.stdout]                                  │
                                                                                                                                                                                                                  │ lea rbx, [var_8h]                                            │
                                                                                                                                                                                                                  │ ; int setvbuf(FILE*stream, char *buf, int mode, size_t size) │
                                                                                                                                                                                                                  │ call sym.imp.setvbuf;[oa]                                    │
                                                                                                                                                                                                                  └──────────────────────────────────────────────────────────────┘
                                                                                                                                                                                                                      v
                                                                                                                                                                                                                      │
                                                                                                                                                                                                                ┌─────┘
┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                                                                                                                               │   │ ┌────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                                                                                                                               │   │ │       ┌───────────────────────────────────────────────────────────────────────────────┐│
│                                                                                                                                                                                                               │   │ │   ┌───│──────────────────────────────────────────────────────────────────────────────┐││
│                                                                                                                                                                                                               │   │ │ ┌─│───│─────────────────────────────────────────────────────────────────────────────┐│││
│                                                                                                                                                                                                               │   │ │ │ │ ┌─│────────────────────────────────────────────────────────────────────────────┐││││
│┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │ │ │ │ │                                                                            │││││
││                                                                                                                                                                                                              │ │ │ │ │ │ │ │                                                                            │││││
││                                                                                                                                                                                                        ┌───────────────────────────────────────────────────────────────────────────────┐                │││││
││                                                                                                                                                                                                        │  0x4011c2                                                                     │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; XREFS: CODE 0x004012ba  CODE 0x00401331  CODE 0x0040134c  CODE 0x004013b7   │                │││││
││                                                                                                                                                                                                        │ ; XREFS: CODE 0x004013dd  CODE 0x004013ee  CODE 0x00401403                    │                │││││
││                                                                                                                                                                                                        │ ; 0x402008                                                                    │                │││││
││                                                                                                                                                                                                        │ ; "\n=== Borne d\u2019enregistrement \u2014 A\u00e9roport Jakarta ==="        │                │││││
││                                                                                                                                                                                                        │ lea rdi, str._n_Borne_denregistrement__Aroport_Jakarta_                       │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; 0x402040                                                                    │                │││││
││                                                                                                                                                                                                        │ ; "1) Lire la carte d\u2019embarquement"                                      │                │││││
││                                                                                                                                                                                                        │ lea rdi, str.1__Lire_la_carte_dembarquement                                   │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; 0x402068                                                                    │                │││││
││                                                                                                                                                                                                        │ ; "2) Surclasser la carte d\u2019embarquement"                                │                │││││
││                                                                                                                                                                                                        │ lea rdi, str.2__Surclasser_la_carte_dembarquement                             │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; 0x402090                                                                    │                │││││
││                                                                                                                                                                                                        │ ; "3) Imprimer les \u00e9tiquettes bagages"                                   │                │││││
││                                                                                                                                                                                                        │ lea rdi, str.3__Imprimer_les_tiquettes_bagages                                │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; 0x40227b                                                                    │                │││││
││                                                                                                                                                                                                        │ ; "4) Quitter"                                                                │                │││││
││                                                                                                                                                                                                        │ lea rdi, str.4__Quitter                                                       │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; const char *s                                                               │                │││││
││                                                                                                                                                                                                        │ ; "> "                                                                        │                │││││
││                                                                                                                                                                                                        │ lea rdi, [0x00402286]                                                         │                │││││
││                                                                                                                                                                                                        │ ; int puts(const char *s)                                                     │                │││││
││                                                                                                                                                                                                        │ call sym.imp.puts;[ob]                                                        │                │││││
││                                                                                                                                                                                                        │ ; FILE *stream                                                                │                │││││
││                                                                                                                                                                                                        │ ; obj.stdout__GLIBC_2.2.5                                                     │                │││││
││                                                                                                                                                                                                        │ ; [0x404020:8]=0                                                              │                │││││
││                                                                                                                                                                                                        │ mov rdi, qword [obj.stdout]                                                   │                │││││
││                                                                                                                                                                                                        │ ; int fflush(FILE *stream)                                                    │                │││││
││                                                                                                                                                                                                        │ call sym.imp.fflush;[oc]                                                      │                │││││
││                                                                                                                                                                                                        │ ; FILE *stream                                                                │                │││││
││                                                                                                                                                                                                        │ ; obj.stdin__GLIBC_2.2.5                                                      │                │││││
││                                                                                                                                                                                                        │ ; [0x404030:8]=0                                                              │                │││││
││                                                                                                                                                                                                        │ mov rdx, qword [obj.stdin]                                                    │                │││││
││                                                                                                                                                                                                        │ ; int size                                                                    │                │││││
││                                                                                                                                                                                                        │ mov esi, 8                                                                    │                │││││
││                                                                                                                                                                                                        │ ; char *s                                                                     │                │││││
││                                                                                                                                                                                                        │ mov rdi, rbx                                                                  │                │││││
││                                                                                                                                                                                                        │ ; char *fgets(char *s, int size, FILE *stream)                                │                │││││
││                                                                                                                                                                                                        │ call sym.imp.fgets;[od]                                                       │                │││││
││                                                                                                                                                                                                        │ test rax, rax                                                                 │                │││││
││                                                                                                                                                                                                        │ je 0x4012c4                                                                   │                │││││
││                                                                                                                                                                                                        └───────────────────────────────────────────────────────────────────────────────┘                │││││
││                                                                                                                                                                                                                f t                                                                                      │││││
││                                                                                                                                                                                                                │ │                                                                                      │││││
││                                                                                                                                                                                                                │ └────────────────────────────────────────────────────────────────────────────────────┐ │││││
││                                                                                                                                                                              ┌─────────────────────────────────┘                                                                                      │ │││││
││                                                                                                                                                                              │                                                                                                                        │ │││││
││                                                                                                                                                                          ┌─────────────────────────────┐                                                                                              │ │││││
││                                                                                                                                                                          │  0x401233                   │                                                                                              │ │││││
││                                                                                                                                                                          │ movzx eax, byte [var_8h]    │                                                                                              │ │││││
││                                                                                                                                                                          │ ; '3'                       │                                                                                              │ │││││
││                                                                                                                                                                          │ ; 51                        │                                                                                              │ │││││
││                                                                                                                                                                          │ cmp al, 0x33                │                                                                                              │ │││││
││                                                                                                                                                                          │ je 0x4012d8                 │                                                                                              │ │││││
││                                                                                                                                                                          └─────────────────────────────┘                                                                                              │ │││││
││                                                                                                                                                                                  f t                                                                                                                  │ │││││
││                                                                                                                                                                                  │ │                                                                                                                  │ │││││
││                                                                                                                                                                                  │ └──────────────────────────────────────────┐                                                                       │ │││││
││                                                                                                              ┌───────────────────────────────────────────────────────────────────┘                                            │                                                                       │ │││││
││                                                                                                              │                                                                                                                │                                                                       │ │││││
││                                                                                                          ┌────────────────────┐                                                                                           ┌──────────────────────────────────────────────────────────────────┐        │ │││││
││                                                                                                          │  0x401240          │                                                                                           │  0x4012d8                                                        │        │ │││││
││                                                                                                          │ jg 0x4012c0        │                                                                                           │ ; const char *mode                                               │        │ │││││
││                                                                                                          └────────────────────┘                                                                                           │ ; CODE XREF from main @ 0x40123a(x)                              │        │ │││││
││                                                                                                                  f t                                                                                                      │ ; "w"                                                            │        │ │││││
││                                                                                                                  │ │                                                                                                      │ lea rsi, [0x004022a1]                                            │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; const char *filename                                           │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; 0x402289                                                       │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; "/dev/null"                                                    │        │ │││││
││                                                                                                                  │ │                                                                                                      │ lea rdi, str._dev_null                                           │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; file*fopen(const char *filename, const char *mode)             │        │ │││││
││                                                                                                                  │ │                                                                                                      │ call sym.imp.fopen;[oh]                                          │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; size_t size                                                    │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; 256                                                            │        │ │││││
││                                                                                                                  │ │                                                                                                      │ mov edi, 0x100                                                   │        │ │││││
││                                                                                                                  │ │                                                                                                      │ mov r12, rax                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ;  void *malloc(size_t size)                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ call sym.imp.malloc;[oi]                                         │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; const char *s                                                  │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; 0x4021e0                                                       │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; "[Borne] Entrez le nombre de bagages enregistr\u00e9s :"       │        │ │││││
││                                                                                                                  │ │                                                                                                      │ lea rdi, str._Borne__Entrez_le_nombre_de_bagages_enregistrs_:    │        │ │││││
││                                                                                                                  │ │                                                                                                      │ mov r13, rax                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; int puts(const char *s)                                        │        │ │││││
││                                                                                                                  │ │                                                                                                      │ call sym.imp.puts;[ob]                                           │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; size_t nbyte                                                   │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; 480                                                            │        │ │││││
││                                                                                                                  │ │                                                                                                      │ mov edx, 0x1e0                                                   │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; void *buf                                                      │        │ │││││
││                                                                                                                  │ │                                                                                                      │ mov rsi, r12                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; int fildes                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ xor edi, edi                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; ssize_t read(int fildes, void *buf, size_t nbyte)              │        │ │││││
││                                                                                                                  │ │                                                                                                      │ call sym.imp.read;[of]                                           │        │ │││││
││                                                                                                                  │ │                                                                                                      │ ; [0x404040:1]=0                                                 │        │ │││││
││                                                                                                                  │ │                                                                                                      │ movzx eax, byte [obj.is_premium]                                 │        │ │││││
││                                                                                                                  │ │                                                                                                      │ test al, al                                                      │        │ │││││
││                                                                                                                  │ │                                                                                                      │ jne 0x4013bc                                                     │        │ │││││
││                                                                                                                  │ │                                                                                                      └──────────────────────────────────────────────────────────────────┘        │ │││││
││                                                                                                                  │ │                                                                                                            t f                                                                   │ │││││
││                                                                                                                  │ │                                                                                                            │ │                                                                   │ │││││
││                                                                                                                  │ └──┐                                                                                                         │ │                                                                   │ │││││
││                                                                                             ┌────────────────────┘    │                                                                                                         │ │                                                                   │ │││││
││                                                                                             │                         │                                                                                                 ┌───────┘ │                                                                   │ │││││
││                                                                                             │                         │                                         ┌─────────────────────────────────────────────────────────────────┘                                                                   │ │││││
││                                                                                             │                         │                                         │                                                       │                                                                             │ │││││
││                                                                                         ┌────────────────────┐    ┌─────────────────────────────────────┐   ┌──────────────────────────────────────────────────┐    ┌────────────────────────────────────────────────────────────────────────────┐    │ │││││
││                                                                                         │  0x401242          │    │  0x4012c0                           │   │  0x401325                                        │    │  0x4013bc                                                                  │    │ │││││
││                                                                                         │ ; '1'              │    │ ; CODE XREF from main @ 0x401240(x) │   │ ; const char *s                                  │    │ ; const char *s                                                            │    │ │││││
││                                                                                         │ ; 49               │    │ ; '4'                               │   │ ; 0x402218                                       │    │ ; CODE XREF from main @ 0x40131f(x)                                        │    │ │││││
││                                                                                         │ cmp al, 0x31       │    │ ; 52                                │   │ ; "[Borne] Statut : Classe \u00c9conomie."       │    │ ; 0x402240                                                                 │    │ │││││
││                                                                                         │ je 0x401358        │    │ cmp al, 0x34                        │   │ lea rdi, str._Borne__Statut_:_Classe_conomie.    │    │ ; "[Imprimante] Impression des \u00e9tiquettes bagages Premium..."         │    │ │││││
││                                                                                         └────────────────────┘    │ jne 0x401340                        │   │ ; int puts(const char *s)                        │    │ lea rdi, str._Imprimante__Impression_des_tiquettes_bagages_Premium...      │    │ │││││
││                                                                                                 f t               └─────────────────────────────────────┘   │ call sym.imp.puts;[ob]                           │    │ ; int puts(const char *s)                                                  │    │ │││││
││                                                                                                 │ │                       f t                               │ jmp 0x4011c2                                     │    │ call sym.imp.puts;[ob]                                                     │    │ │││││
││                                                                                                 │ │                       │ │                               └──────────────────────────────────────────────────┘    │ ; FILE *stream                                                             │    │ │││││
││                                                                                                 │ │                       │ │                                   v                                                   │ mov rcx, r12                                                               │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ ; size_t nitems                                                            │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ ; 256                                                                      │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ mov edx, 0x100                                                             │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ ; const void *ptr                                                          │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ mov rdi, r13                                                               │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ ; size_t size                                                              │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ mov esi, 1                                                                 │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ ; size_t fwrite(const void *ptr, size_t size, size_t nitems, FILE *stream) │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ call sym.imp.fwrite;[ok]                                                   │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   │ jmp 0x4011c2                                                               │    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                   └────────────────────────────────────────────────────────────────────────────┘    │ │││││
││                                                                                                 │ │                       │ │                                   │                                                       v                                                                             │ │││││
││                                                                                                 │ │                       │ │                                   │                                                       │                                                                             │ │││││
││                                                                                                 │ └───────────────────────│─│───────────────────────────────────│──────────────────────────────────────────────────────┐│                                                                             │ │││││
││                                                                                             ┌───┘                         │ └───────────────────────────────────│───────────────────────────────────────────────────────│─────────────────────────────────────────────────────────────────────────────│┐│││││
││                                                                                             │                             └─────────────────────────────────────│──────────────┐                                       ││                                                                             │││││││
││                                                                                             │                                                                   └───────────────────────────────────────────────────────│───────────────────────────────────────────────────────────────────────────────┘││││
││                                                                                             │                                                                                  │                                       │└──────────────────────────────────────────────────────────────────────────────────┘│
││                                                                                             │                                                                                  │ ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘│ ││ │
││                                                                                             │                                                                                  │ │                                     │                                                                               │ ││ │
││                                                                                         ┌────────────────────┐                                                           ┌─────────────────────────────────────┐   ┌───────────────────────────────────────────────────────────────────────────────┐   │ ││ │
││                                                                                         │  0x40124a          │                                                           │  0x4012c4                           │   │  0x401358                                                                     │   │ ││ │
││                                                                                         │ ; '2'              │                                                           │ ; CODE XREF from main @ 0x40122d(x) │   │ ; const char *mode                                                            │   │ ││ │
││                                                                                         │ ; 50               │                                                           │ add rsp, 0x18                       │   │ ; CODE XREF from main @ 0x401244(x)                                           │   │ ││ │
││                                                                                         │ cmp al, 0x32       │                                                           │ xor eax, eax                        │   │ ; "r"                                                                         │   │ ││ │
││                                                                                         │ jne 0x401340       │                                                           │ pop rbx                             │   │ lea rsi, [0x00402284]                                                         │   │ ││ │
││                                                                                         └────────────────────┘                                                           │ pop rbp                             │   │ ; const char *filename                                                        │   │ ││ │
││                                                                                                 f t                                                                      │ pop r12                             │   │ ; 0x402289                                                                    │   │ ││ │
││                                                                                                 │ │                                                                      │ pop r13                             │   │ ; "/dev/null"                                                                 │   │ ││ │
││                                                                                                 │ │                                                                      │ ret                                 │   │ lea rdi, str._dev_null                                                        │   │ ││ │
││                                                                                                 │ │                                                                      └─────────────────────────────────────┘   │ ; file*fopen(const char *filename, const char *mode)                          │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.fopen;[oh]                                                       │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; size_t size                                                                 │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; 256                                                                         │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov edi, 0x100                                                                │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov r12, rax                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ;  void *malloc(size_t size)                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.malloc;[oi]                                                      │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; const char *s                                                               │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; 0x4020b8                                                                    │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; "[Borne] Veuillez ins\u00e9rer votre carte d\u2019embarquement :"           │   │ ││ │
││                                                                                                 │ │                                                                                                                │ lea rdi, str._Borne__Veuillez_insrer_votre_carte_dembarquement_:              │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov r13, rax                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; int puts(const char *s)                                                     │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.puts;[ob]                                                        │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; void *buf                                                                   │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov rsi, r12                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; size_t nbyte                                                                │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; 480                                                                         │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov edx, 0x1e0                                                                │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; int fildes                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ xor edi, edi                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; ssize_t read(int fildes, void *buf, size_t nbyte)                           │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.read;[of]                                                        │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; const char *s                                                               │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; 0x4020f8                                                                    │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; "[Imprimante] Impression de la carte d\u2019embarquement en cours..."       │   │ ││ │
││                                                                                                 │ │                                                                                                                │ lea rdi, str._Imprimante__Impression_de_la_carte_dembarquement_en_cours...    │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; int puts(const char *s)                                                     │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.puts;[ob]                                                        │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; FILE *stream                                                                │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov rcx, r12                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; size_t nmemb                                                                │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov edx, 1                                                                    │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; void *ptr                                                                   │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov rdi, r13                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; size_t size                                                                 │   │ ││ │
││                                                                                                 │ │                                                                                                                │ mov esi, 1                                                                    │   │ ││ │
││                                                                                                 │ │                                                                                                                │ ; size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)            │   │ ││ │
││                                                                                                 │ │                                                                                                                │ call sym.imp.fread;[oj]                                                       │   │ ││ │
││                                                                                                 │ │                                                                                                                │ jmp 0x4011c2                                                                  │   │ ││ │
││                                                                                                 │ │                                                                                                                └───────────────────────────────────────────────────────────────────────────────┘   │ ││ │
││                                                                                                 │ │                                                                                                                    v                                                                               │ ││ │
││                                                                                                 │ │                                                                                                                    │                                                                               │ ││ │
││                                                                                                 │ └──────────────────────────────────────────────────────────────────────────────┐                                     │                                                                               │ ││ │
││                                                                                     ┌───────────┘                                                                                │                                     │                                                                               │ ││ │
││                                                                                     │                                                                                            │                                     └──────────────────────────────────────────────────────────────────────────────────┘ │
││                                                                                     │                                                                                            │ ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │  │
││                                                                                     │                                                                                            │ │                                                                                                                     │  │
││                                                                                 ┌─────────────────────────────────────┐                                                    ┌───────────────────────────────────────────────────┐                                                                         │  │
││                                                                                 │  0x401252                           │                                                    │  0x401340                                         │                                                                         │  │
││                                                                                 │ ; [0x404040:1]=0                    │                                                    │ ; const char *s                                   │                                                                         │  │
││                                                                                 │ movzx eax, byte [obj.is_premium]    │                                                    │ ; CODE XREFS from main @ 0x40124c(x), 0x4012c2(x) │                                                                         │  │
││                                                                                 │ test al, al                         │                                                    │ ; 0x4022a3                                        │                                                                         │  │
││                                                                                 │ je 0x4013e2                         │                                                    │ ; "Choix invalide."                               │                                                                         │  │
││                                                                                 └─────────────────────────────────────┘                                                    │ lea rdi, str.Choix_invalide.                      │                                                                         │  │
││                                                                                         f t                                                                                │ ; int puts(const char *s)                         │                                                                         │  │
││                                                                                         │ │                                                                                │ call sym.imp.puts;[ob]                            │                                                                         │  │
││                                                                                         │ │                                                                                │ jmp 0x4011c2                                      │                                                                         │  │
││                                                                                         │ │                                                                                └───────────────────────────────────────────────────┘                                                                         │  │
││                                                                                         │ │                                                                                    v                                                                                                                         │  │
││                                                                                         │ │                                                                                    │                                                                                                                         │  │
││                                                                                         │ └───────────────┐                                                                    │                                                                                                                         │  │
││         ┌───────────────────────────────────────────────────────────────────────────────┘                 │                                                                    │                                                                                                                         │  │
││         │                                                                                                 │                                                                    └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  │
││         │                                                                                                 │                                                                                                                                                                                                 │
││     ┌─────────────────────────────────────────────────────────────────────────────────────────────┐   ┌────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                            │
││     │  0x401261                                                                                   │   │  0x4013e2                                                                              │                                                                                                            │
││     │ ; const char *s                                                                             │   │ ; const char *s                                                                        │                                                                                                            │
││     │ ; 0x402190                                                                                  │   │ ; CODE XREF from main @ 0x40125b(x)                                                    │                                                                                                            │
││     │ ; "[Imprimante] Code de surclassement d\u00e9tect\u00e9 sur la carte d\u2019embarquement :" │   │ ; 0x402140                                                                             │                                                                                                            │
││     │ lea rdi, str._Imprimante__Code_de_surclassement_dtect_sur_la_carte_dembarquement_:          │   │ ; "[Imprimante] Classe \u00c9conomie uniquement \u2014 pas de surclassement possible." │                                                                                                            │
││     │ ; int puts(const char *s)                                                                   │   │ lea rdi, str._Imprimante__Classe_conomie_uniquement__pas_de_surclassement_possible.    │                                                                                                            │
││     │ call sym.imp.puts;[ob]                                                                      │   │ ; int puts(const char *s)                                                              │                                                                                                            │
││     │ ; int oflag                                                                                 │   │ call sym.imp.puts;[ob]                                                                 │                                                                                                            │
││     │ xor esi, esi                                                                                │   │ jmp 0x4011c2                                                                           │                                                                                                            │
││     │ ; const char *path                                                                          │   └────────────────────────────────────────────────────────────────────────────────────────┘                                                                                                            │
││     │ ; 0x402293                                                                                  │       v                                                                                                                                                                                                 │
││     │ ; "/tmp/flag.txt"                                                                           │       │                                                                                                                                                                                                 │
││     │ lea rdi, str._tmp_flag.txt                                                                  │       │                                                                                                                                                                                                 │
││     │ xor eax, eax                                                                                │       │                                                                                                                                                                                                 │
││     │ ; int open(const char *path, int oflag)                                                     │       │                                                                                                                                                                                                 │
││     │ call sym.imp.open;[oe]                                                                      │       │                                                                                                                                                                                                 │
││     │ mov r12d, eax                                                                               │       │                                                                                                                                                                                                 │
││     │ test eax, eax                                                                               │       │                                                                                                                                                                                                 │
││     │ js 0x4013f3                                                                                 │       │                                                                                                                                                                                                 │
││     └─────────────────────────────────────────────────────────────────────────────────────────────┘       │                                                                                                                                                                                                 │
││             f t                                                                                           │                                                                                                                                                                                                 │
││             │ │                                                                                           │                                                                                                                                                                                                 │
││             │ └──────────────────────────────────────────────┐                                            │                                                                                                                                                                                                 │
││    ┌────────┘                                                │                                            │                                                                                                                                                                                                 │
││    │                                                         │                                            └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
││    │                                                         │
││┌─────────────────────────────────────────────────────┐   ┌─────────────────────────────────────┐
│││  0x401288                                           │   │  0x4013f3                           │
│││ ; size_t nbyte                                      │   │ ; CODE XREF from main @ 0x401282(x) │
│││ ; '\x7f'                                            │   │ ; [0x404060:8]=0                    │
│││ ; 127                                               │   │ mov qword [obj.win], rbp            │
│││ mov edx, 0x7f                                       │   │ ; 'e'                               │
│││ ; void *buf                                         │   │ ; [0x404068:2]=0                    │
│││ ; 0x404060                                          │   │ mov word [0x00404068], 0x65         │
│││ lea rsi, obj.win                                    │   │ jmp 0x4011c2                        │
│││ ; int fildes                                        │   └─────────────────────────────────────┘
│││ mov edi, eax                                        │       v
│││ ; ssize_t read(int fildes, void *buf, size_t nbyte) │       │
│││ call sym.imp.read;[of]                              │       │
│││ mov edx, 0                                          │       │
│││ ; int fildes                                        │       │
│││ mov edi, r12d                                       │       │
│││ test rax, rax                                       │       │
│││ cmovs rax, rdx                                      │       │
│││ ; 0x404060                                          │       │
│││ lea rdx, obj.win                                    │       │
│││ mov byte [rdx + rax], 0                             │       │
│││ ; int close(int fildes)                             │       │
│││ call sym.imp.close;[og]                             │       │
│││ jmp 0x4011c2                                        │       │
││└─────────────────────────────────────────────────────┘       │
││    v                                                         │
││    │                                                         │
│└────┘                                                         │
└───────────────────────────────────────────────────────────────┘

```





